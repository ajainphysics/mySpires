{"version":3,"sources":["../index.js"],"names":["mySpiresSearch","busy","Promise","resolve","records","savedSearches","urgentBreak","urgentBreakPromise","then","urgentFlag","urgent","console","log","$","$searchBox","$searchInput","find","$searchBarReset","$searchBtn","$pagination","$paginationFirst","$paginationPrevious","$paginationNext","$paginationLast","Object","defineProperties","rg","get","Number","attr","set","val","jrec","totalResults","searchQuery","submit","change","click","focus","e","preventDefault","hasClass","Math","floor","firstSearchQuery","MARC","record","tag","code","html","loadINSPIRE","searchURI","encodeURI","savedSearch","Date","getTime","timestamp","reject","results","InspireRecords","addFields","inspireArray","push","inspire","mySpires_Record","totResults","catch","show","blur","map","id","hide","promiseArray","publishedDate","published","monthNamesSmall","dspPublishedDate","getMonth","getDate","getFullYear","append","arxiv","title","author","abstract","$box","$links","citation_count","remove","dragging","touchStartTime","on","touchTime","off","toggleClass","all","removeClass","addClass","MathJax","Hub","Queue","mySpires","api","q","join","field","mySpires_Bar","window","history","pushState","search","onpopstate","state"],"mappings":"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","file":"index.js","sourcesContent":["const mySpiresSearch = {};\nmySpiresSearch.busy = Promise.resolve();\nmySpiresSearch.records = {};\nmySpiresSearch.savedSearches = {};\n\nmySpiresSearch.urgentBreak = function() {\n    if(mySpiresSearch.urgentBreakPromise) mySpiresSearch.urgentBreakPromise();\n    mySpiresSearch.busy.then(function() {\n        mySpiresSearch.urgentFlag = false;\n        mySpiresSearch.urgent = new Promise((resolve) => {\n            mySpiresSearch.urgentBreakPromise = function() {\n                resolve(\"urgent\");\n                mySpiresSearch.urgentFlag = true;\n                console.log(\"Breaking promises urgently!\");\n            }\n        });\n    });\n};\nmySpiresSearch.urgentBreak();\n\n$(function() {\n    mySpiresSearch.$searchBox = $(\"#welcome-search\");\n    mySpiresSearch.$searchInput = mySpiresSearch.$searchBox.find(\".searchfield\");\n    mySpiresSearch.$searchBarReset = mySpiresSearch.$searchBox.find(\".search-bar-reset\");\n    mySpiresSearch.$searchBtn = mySpiresSearch.$searchBox.find(\".searchbtn\");\n    mySpiresSearch.$pagination = $(\".search-pagination\");\n    mySpiresSearch.$paginationFirst = mySpiresSearch.$pagination.find(\".search-pagination-first\");\n    mySpiresSearch.$paginationPrevious = mySpiresSearch.$pagination.find(\".search-pagination-previous\");\n    mySpiresSearch.$paginationNext = mySpiresSearch.$pagination.find(\".search-pagination-next\");\n    mySpiresSearch.$paginationLast = mySpiresSearch.$pagination.find(\".search-pagination-last\");\n\n    Object.defineProperties(mySpiresSearch, {\n        rg: {\n            get: function() {return Number(mySpiresSearch.$pagination.attr(\"data-rg\"))},\n            set: function(val) {mySpiresSearch.$pagination.attr(\"data-rg\", Number(val))}\n        },\n        jrec: {\n            get: function() {return Number(mySpiresSearch.$pagination.attr(\"data-jrec\"))},\n            set: function(val) {mySpiresSearch.$pagination.attr(\"data-jrec\", Number(val))}\n        },\n        totalResults: {\n            get: function() {return Number(mySpiresSearch.$pagination.attr(\"data-total-results\"));},\n            set: function(val) {mySpiresSearch.$pagination.attr(\"data-total-results\", Number(val))}\n        },\n\n        searchQuery: {\n            get: function() {return mySpiresSearch.$searchInput.val()},\n            set: function(val) {mySpiresSearch.$searchInput.val(val)}\n        }\n    });\n\n    mySpiresSearch.$searchBox.submit(function() {\n        mySpiresSearch.change();\n    });\n\n    mySpiresSearch.$searchBarReset.click(function() {\n        mySpiresSearch.$searchInput.val(\"\").focus();\n    });\n\n    mySpiresSearch.$paginationFirst.click(function(e) {\n        e.preventDefault();\n        if($(this).hasClass(\"disabled\")) return;\n        mySpiresSearch.change();\n    });\n    mySpiresSearch.$paginationPrevious.click(function(e) {\n        e.preventDefault();\n        if($(this).hasClass(\"disabled\")) return;\n        mySpiresSearch.change(\"\", mySpiresSearch.jrec - mySpiresSearch.rg);\n    });\n    mySpiresSearch.$paginationNext.click(function(e) {\n        e.preventDefault();\n        if($(this).hasClass(\"disabled\")) return;\n        mySpiresSearch.change(\"\", mySpiresSearch.jrec + mySpiresSearch.rg);\n    });\n    mySpiresSearch.$paginationLast.click(function(e) {\n        e.preventDefault();\n        if($(this).hasClass(\"disabled\")) return;\n        mySpiresSearch.change(\"\", mySpiresSearch.rg * Math.floor(mySpiresSearch.totalResults / mySpiresSearch.rg) + 1);\n    });\n\n    mySpiresSearch.firstSearchQuery = mySpiresSearch.searchQuery;\n\n    mySpiresSearch.set();\n});\n\nmySpiresSearch.MARC = function(record, tag, code = null) {\n    if(code) return record.find(\"[tag='\" + tag + \"'] [code='\" + code + \"']\").html();\n    else return record.find(\"[tag='\" + tag + \"']\").html();\n};\n\n/**\n * Loads a query string from INSPIRE into cache.\n * @param {string} searchQuery The query to be searched for on INSPIRE.\n * @param {int} jrec Where to start the results.\n * @return {boolean}\n */\nmySpiresSearch.loadINSPIRE = function (searchQuery, jrec = 1) {\n    if(jrec <= 0) jrec = 1;\n    let rg = 25;\n    if(!searchQuery) return false;\n\n    // Get the saved results.\n    let searchURI = encodeURI(searchQuery + \"&rg=\" + rg + \"&jrec=\" + jrec);\n    let savedSearch = mySpiresSearch.savedSearches[searchURI];\n    // If results are available and were obtained less than 12 hours ago, do nothing.\n    if(savedSearch && ((new Date()).getTime() - savedSearch.timestamp < 12 * 60 * 60 * 1000)) return false;\n\n    mySpiresSearch.busy = new Promise((resolve, reject) => {mySpiresSearch.busy.then(function() {\n        // If urgent resolves, resolve the promise and move on.\n        mySpiresSearch.urgent.then(resolve);\n        if (mySpiresSearch.urgentFlag) return; // If urgent, abort!\n\n        let results = new InspireRecords(searchQuery, {rg: rg, jrec: jrec, addFields: \"abstract\"});\n        results.busy.then(function() {\n            let inspireArray = [];\n            for(let record of results.records) {\n                inspireArray.push(record.inspire);\n                mySpiresSearch.records[record.inspire] = new mySpires_Record(record);\n            }\n\n            mySpiresSearch.savedSearches[searchURI] = {\n                totalResults: results.totResults,\n                timestamp: (new Date()).getTime(),\n                results: inspireArray\n            };\n\n            resolve();\n        }).catch(reject);\n\n    }).catch(reject)});\n\n    return true;\n};\n\nmySpiresSearch.set = function(searchQuery = \"\", jrec = 1) {\n    mySpiresSearch.urgentBreak();\n\n    if(jrec <= 0) jrec = 1;\n    let rg = 25;\n\n    if(searchQuery) mySpiresSearch.searchQuery = searchQuery;\n    else searchQuery = mySpiresSearch.searchQuery;\n    if(!searchQuery) return false; // Don't search if there is nothing to search\n\n    // let searchURI = encodeURI(\"search=\" + searchQuery + \"&rg=\" + rg + \"&jrec=\" + jrec);\n    let searchURI = encodeURI(searchQuery + \"&rg=\" + rg + \"&jrec=\" + jrec);\n\n    // The loading markers\n    $(\".busy-loader\").show();\n    mySpiresSearch.$searchBtn.html(\"<i class='fa fa-spinner fa-spin'></i>\");\n\n    // Set the query string in the searchbox (useful when called by a button or history).\n    mySpiresSearch.$searchInput.val(\"\").val(searchQuery).blur();\n\n    // mySpiresSearch.load(searchQuery, jrec); // Load the results // From the server\n    mySpiresSearch.loadINSPIRE(searchQuery, jrec);\n\n    mySpiresSearch.busy = new Promise((resolve, reject) => {mySpiresSearch.busy.then(function() {\n        let savedSearch = mySpiresSearch.savedSearches[searchURI]; // Pick up the search results\n        let records = savedSearch.results.map(function(id) {return mySpiresSearch.records[id]}); // Fetch the records\n        let totalResults = savedSearch.totalResults; // Fetch the total results\n\n        // Reset the search results DOM\n        mySpiresSearch.$pagination.hide();\n        $(\".search-results\").html(\"\");\n\n        let promiseArray = [];\n        for(let record of records) {\n            record.busy.then(function() {\n                let publishedDate = new Date(record.published);\n                let monthNamesSmall = [\"Jan\", \"Feb\", \"Mar\", \"Apr\", \"May\", \"Jun\", \"Jul\", \"Aug\", \"Sep\", \"Oct\", \"Nov\", \"Dec\"];\n                let dspPublishedDate = monthNamesSmall[publishedDate.getMonth()] + \" \"\n                    + publishedDate.getDate() + \", \"\n                    + publishedDate.getFullYear();\n\n                $(\"#welcome-search-results\").append(\n                    '<div id=\"search-result-' + record.inspire + '\" class=\"search-result\">' +\n                    '    <div class=\"id-wrapper\">' +\n                    '        <span class=\"inspire-id\"><a href=\"https://inspirehep.net/record/' + record.inspire + '\" target=\"_blank\">' +\n                    '            inspirehep/' + record.inspire +\n                    '        </a></span>' +\n                    '        <span class=\"id-bullet\">&bull;</span>' +\n                    '        <span class=\"arxiv-id\"><a href=\"https://arxiv.org/abs/' + record.arxiv + '\" target=\"_blank\">' +\n                    '            arXiv:' + record.arxiv +\n                    '        </a></span>' +\n                    '    </div>' +\n                    '    <div class=\"title-wrapper\">' +\n                    '        <h2 class=\"paper-title\">' +\n                    '        <a href=\"https://inspirehep.net/record/' + record.inspire + '\" target=\"_blank\">' + record.title + '</a>' +\n                    '    </h2></div>' +\n                    '    <div class=\"author-wrapper\"><p class=\"paper-authors\">' +\n                    '        ' + record.author +\n                    '    </p></div>' +\n                    '    <div class=\"date-wrapper\">' +\n                    '        <span class=\"published-date\">' + dspPublishedDate + '</span>' +\n                    '    </div>' +\n                    '    <div class=\"links-wrapper\">' + '</div>' +\n                    '    <div class=\"mySpires-bar homeserver\"></div>' +\n                    '    <div class=\"abstract-wrapper folded\">' +\n                    '        <div class=\"paper-abstract\">' + record.abstract + '</div>' +\n                    '        <div class=\"fadeout\"></div>' +\n                    '    </div>' +\n                    '</div>'\n                );\n\n                let $box = $(\"#search-result-\" + record.inspire);\n\n                let $links = $box.find(\".links-wrapper\");\n\n                if(record.arxiv)\n                    $links.append('<a href=\"https://arxiv.org/pdf/' + record.arxiv + '\" target=\"_blank\">' +\n                        'PDF <span class=\"sep\">|</span> </a>');\n\n                $links.append('<a href=\"http://inspirehep.net/record/' + record.inspire + '/export/hx\"' +\n                    ' target=\"_blank\">BibTeX <span class=\"sep\">|</span> </a>');\n\n                $links.append('<a class=\"references-link\" href=\"#\">' + 'References <span class=\"sep\">|</span> </a>');\n                $links.find(\".references-link\").click(function(e) {\n                    e.preventDefault();\n                    mySpiresSearch.change(\"find citedby recid \" + record.inspire);\n                });\n\n                if(record.citation_count) {\n                    $links.append('<a class=\"citations-link\" href=\"#\">' + 'Citations (' + record.citation_count + ')</a>');\n                    $links.find(\".citations-link\").click(function(e) {\n                        e.preventDefault();\n                        mySpiresSearch.change(\"find refersto recid \" + record.inspire);\n                    });\n                }\n\n                $links.find(\"a:last-child span.sep\").remove();\n\n                if(!record.abstract) {\n                    $box.find(\".abstract-wrapper\").remove();\n                } else {\n                    let dragging = false;\n                    let touchStartTime;\n                    $box.find(\".abstract-wrapper\")\n                        .on(\"touchstart\", function(){\n                            dragging = false;\n                            touchStartTime = (new Date()).getTime();\n                        })\n                        .on(\"touchmove\", function(){\n                            dragging = true;\n                        })\n                        .on(\"touchend\", function() {\n                            let touchTime = (new Date()).getTime() - touchStartTime;\n                            if(!dragging && touchTime < 1000)\n                                $(this).off(\"click\").toggleClass(\"folded\");\n                        })\n                        .on(\"click\", function() {\n                            $(this).toggleClass(\"folded\");\n                        });\n                }\n\n                // new mySpires_Bar(record, $box);\n\n            }).catch(reject);\n\n            promiseArray.push(record.busy);\n        }\n\n        Promise.all(promiseArray).then(function() {\n            $(\".busy-loader\").hide();\n            mySpiresSearch.$searchBtn.html(\"Go\");\n\n            if(totalResults > rg) {\n                mySpiresSearch.rg = rg;\n                mySpiresSearch.jrec = jrec;\n                mySpiresSearch.totalResults = totalResults;\n\n                mySpiresSearch.$pagination.find(\".search-pagination-status a\")\n                    .html(jrec +\" - \" + (rg + jrec - 1) + \" of \" + totalResults);\n\n                if(jrec !== 1) {\n                    mySpiresSearch.$paginationFirst.removeClass(\"disabled\");\n                    mySpiresSearch.$paginationPrevious.removeClass(\"disabled\");\n                }\n                else {\n                    mySpiresSearch.$paginationFirst.addClass(\"disabled\");\n                    mySpiresSearch.$paginationPrevious.addClass(\"disabled\");\n                }\n\n                if(jrec + rg - 1 < totalResults) {\n                    mySpiresSearch.$paginationLast.removeClass(\"disabled\");\n                    mySpiresSearch.$paginationNext.removeClass(\"disabled\");\n                }\n                else {\n                    mySpiresSearch.$paginationLast.addClass(\"disabled\");\n                    mySpiresSearch.$paginationNext.addClass(\"disabled\");\n                }\n\n                mySpiresSearch.$pagination.show();\n            }\n\n            MathJax.Hub.Queue([\"Typeset\", MathJax.Hub]);\n\n            mySpires.api({q:savedSearch.results.join(), field: \"inspire\"}).then(function(records) {\n                for(let inspire of savedSearch.results) {\n                    // If a saved record is found, replace it.\n                    if(records[inspire])\n                        mySpiresSearch.records[inspire] = new mySpires_Record(records[inspire]);\n\n                    // Draw the mySpires bar.\n                    new mySpires_Bar(mySpiresSearch.records[inspire], $(\"#search-result-\" + inspire))\n                }\n                resolve();\n            }).catch(reject);\n\n        }).catch(reject);\n\n        /*\n        // Do some forward planning\n        mySpiresSearch.load(searchQuery, jrec + rg);\n        mySpiresSearch.load(searchQuery, jrec - rg);\n        for(let record of records) {\n            mySpiresSearch.load(\"find citedby recid \" + record.inspire);\n            if(record.citation_count)\n                mySpiresSearch.load(\"find refersto recid \" + record.inspire);\n        }\n        */\n\n    }).catch(reject)});\n    return true;\n};\n\n\nmySpiresSearch.change = function(searchQuery = \"\", jrec = 1) {\n    if(mySpiresSearch.set(searchQuery, jrec)) {\n        mySpiresSearch.busy.then(function() {\n            searchQuery = mySpiresSearch.searchQuery;\n            window.history.pushState({search: searchQuery, jrec: jrec}, \"\", \"/?q=\" + searchQuery);\n        });\n        return true;\n    } else\n        return false;\n};\n\nwindow.onpopstate = function (e) {\n    let searchQuery;\n    let jrec;\n    if(e.state && e.state.search) {\n        searchQuery = e.state.search;\n        jrec = e.state.jrec;\n    }\n    else {\n        searchQuery = mySpiresSearch.firstSearchQuery;\n        jrec = 1;\n    }\n\n    mySpiresSearch.set(searchQuery, jrec);\n};"]}