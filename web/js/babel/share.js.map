{"version":3,"sources":["../share.js"],"names":["$","query","val","$spinner","show","mySpires","api","share","then","data","tag","opts","records","keys","Object","sort","a","b","t","updated","split","Date","html","length","i","trigger","setInterval","entry","mySpires_Box","box","fadeIn","undefined","clearInterval","entryTagsAuthors","select2","placeholder","containerCssClass","concat","hide","subtags","subtag","substr","subtagBox","loadSubtag","tagShow","trim","remove","authorShow","replace","author","change","sortPapers","console","log","method","order","attr","entryBox","publishedDate","appendTo","click"],"mappings":"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","file":"share.js","sourcesContent":["// TODO: Write a more robust tag, authors retrieval system.\n\n$(function() {\n    let query = $(\"#sharequery\").val();\n\n    let $spinner = $(\".paper-spinner-wrapper\").show();\n    mySpires.api({share: query}).then(function(data) {\n        let tag = data.opts.tag,\n            records = data.records;\n\n        let keys = Object.keys(records);\n        keys.sort(function(a, b) {\n            let t = records[a].updated.split(/[- :]/);\n            a = new Date(t[0], t[1] - 1, t[2], t[3], t[4], t[5]);\n            t = records[b].updated.split(/[- :]/);\n            b = new Date(t[0], t[1] - 1, t[2], t[3], t[4], t[5]);\n\n            return (a > b) ? -1 : (a < b) ? 1 : 0;\n        });\n\n        if(tag === \"Untagged\") $(\".paper-boxes .type-header h3\").html(\"Untagged (\" + keys.length + \")\");\n        else $(\".paper-boxes .type-header h3\").html(\"Records (\" + keys.length + \")\");\n\n        if(keys.length !== 0) {\n            let i = 0;\n            let trigger = setInterval(function () {\n                let entry = records[keys[i]];\n\n                let a = new mySpires_Box(entry);\n                a.box.fadeIn();\n\n                if (keys[++i] === undefined) clearInterval(trigger);\n            }, 10);\n\n            if(tag === \"Untagged\") entryTagsAuthors[tag] = entryTagsAuthors[\"\"];\n            $(\"#filter-authors\").html(\"\").select2({\n                placeholder: 'Select an option' + tag,\n                containerCssClass: \"selectors\",\n                data: [\"All Authors\"].concat(entryTagsAuthors[tag])\n            });\n        }\n\n        $spinner.hide();\n    });\n\n    return;\n\n    if(subtags.length === 0) $(\".subtags .type-header\").hide();\n    else if(tag === \"Untagged\") $(\".subtags .type-header h3\").html(\"Tags (\" + subtags.length + \")\");\n    else $(\".subtags .type-header h3\").html(\"Subtags (\" + subtags.length + \")\");\n    \n    for(let i in subtags) {\n        let subtag;\n        if(tag === \"Untagged\") {\n            subtag = subtags[i];\n        } else {\n            subtag = tag + \"/\" + subtags[i].substr(tag.length + 1);\n        }\n        subtagBox.loadSubtag(subtag);\n    }\n});\n\nfunction tagShow() {\n    let tag = $(\"#filter-tags\").val();\n\n    if(tag.trim().length === 0) {\n        tag = \"Untagged\";\n        $(\"#filter-tags\").val(tag);\n    }\n\n    $(\"div.paper-box\").remove();\n\n    let $spinner = $(\".paper-spinner-wrapper\").show();\n\n    mySpires.tag(tag).then(function(records) {\n\n\n    });\n\n    return true;\n}\n\nfunction authorShow() {\n    let tag = $(\"#filter-tags\").val();\n    tag = tag.replace(/ /g, \"_\").replace(/\\//g, \"__\");\n\n    let author = $(\"#filter-authors\").val();\n\n    $(\"div.paper-box\").hide();\n\n    if (author === \"All Authors\") {\n        $(\"div.paper-box.tag-\" + tag).show();\n    } else {\n        $(\"div.paper-box.tag-\" + tag + \".author-\" + author).show();\n    }\n\n    // sortPapers();\n\n    return true;\n}\n\n$(\"#filter-authors\").change(authorShow);\n\nfunction sortPapers() {\n    console.log(1);\n\n    let method = $(\"#filter-sort\").val();\n    let order = $(\"#filter-sort-button\").attr(\"order\");\n\n    if (method === \"published\") {\n        $('div.paper-box:visible').sort(function (a, b) {\n            a = entryBox[$(a).attr(\"id\").split(\"-\")[1]].publishedDate;\n            b = entryBox[$(b).attr(\"id\").split(\"-\")[1]].publishedDate;\n            if (order === \"asc\") return (a < b) ? -1 : (a > b) ? 1 : 0;\n            else return (a < b) ? 1 : (a > b) ? -1 : 0;\n        }).appendTo(\".paper-boxes\");\n    }\n\n    return true;\n}\n\n// $(sortPapers);\n$(function() {\n    $(\"#filter-sort\").change(sortPapers);\n    $(\"#filter-sort-button\").click(function () {\n        let order = $(this).attr(\"order\");\n\n        if (order === \"asc\") $(\"#filter-sort-button\").attr(\"order\", \"desc\").html(\"<i class='fa fa-sort-numeric-desc'></i>\");\n        else $(\"#filter-sort-button\").attr(\"order\", \"asc\").html(\"<i class='fa fa-sort-numeric-asc'></i>\");\n\n        sortPapers();\n    });\n});"]}